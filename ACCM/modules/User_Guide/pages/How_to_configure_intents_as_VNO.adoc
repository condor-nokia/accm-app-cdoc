include::ROOT:conf/Configuration_properties.adoc[leveloffset=0]

= How to configure intents as {vno-initials}

== Introduction

This section describes how to use the {app-short-name} IBN proxy as an {vno-initials}.
Although only the fundamental operations for an IBN {vno-initials} are described, the application
acts as a proxy and supports the use of all operations provided by the Altiplano Intent Based Networking interface.

When {app-short-name} is installed over Altiplano, the {vno-initials} must execute all the requests through the application proxy.
Instead of using the Altiplano's IBN URL:
https://{altiplano-host}/nokia-altiplano-ac/

The {vno-initials}s must point to {app-short-name} IBN proxy URL:
https://{altiplano-host}/{wnp-ibn-context}/

{app-short-name} can apply different configurations and rules for each {vno-initials}.
These {vno-initials}s must be added to the {app-short-name} and configured.
The default allowed intent types configured in {app-short-name} are ont, l2-user and mcast-user. In this section the
examples refers to the {ont-initials} intents but the same can be applied for the others.
Refer to xref:User_Guide:How_to_use_WNP_as_INP.adoc[How to Use {app-short-name} as {inp-initials}] section to know how to define rules globally and per {vno-initials}.

[NOTE]
====
Before using {app-short-name} as an {vno-initials} you must be authenticated as {vno-initials} user.
Refer to xref:User_Guide:How_to_manage_WNP_access.adoc[How to Manage {app-short-name} access] section to know the steps needed.
====

== Create Intents
When an {vno-initials} wants to create an intent it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

The {vno-initials} is able to create intents of the types that are configured in the allow list of the {app-short-name}.

=== Using the {app-short-name} WebUI

To create a new {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the *Add {ont-initials}* button.
+
image::vno_portal/ONTsSection_newButton.png[align="center"]

. Enter the required data in the popup window.
+
image::vno_portal/ONTsSection_createONT.png[align="left"]

. Enter all required values:
+
- *Version:* It is the intent type yang model version.
- *Required network state:* It is the network's state. Can be selected between: Active, Suspended or Not present.
- *{ont-initials} Name:* It is the {ont-initials}'s name.
- *Fiber Name*: It is the PON port.
- *PON Type*: It is the PON port type. Example: gpon.
- *ONT Type*: It is the ONT model.
- *Expected Serial Number*: It is the ONT serial number.
- *ONT Service Profile*: It is the service profile for the ONT.
- *UNI Service Configuration*: An UNI service profile must be added.

. Click the *SAVE* button.

=== Using the REST Proxy
To create an intent using the {app-short-name} IBN proxy a POST request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {app-short-name} proxy context (*{wnp-ibn-context}*).
====

For example:: If an {vno-initials} wants to create an ont intent:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn
+
The following request body must be sent:
+
[source, json]
----
{
	"ibn:intent": {
		"target": "FX-41.L1.P1-1",
		"intent-type": "ont",
		"required-network-state": "active",
		"intent-specific-data": {
			"ont:ont": {
				"ont-type": "G-010G-A",
				"fiber-name": "FX-41.LT1.PON1",
				"expected-serial-number": "ALCLF8464049",
				"onu-service-profile": "default",
				"uni-service-configuration": {
					"uni-id": "LAN1",
					"service-profile": "default"
				}
			}
		}
	}
}
----

[NOTE]
====
The access token of the {vno-initials} user must be sent in the request as a Bearer Authorization HTTP Header.
To retrieve a token, follow the steps in the xref:How_to_manage_WNP_access.adoc#_rest_apis_proxies_and_kafka_brokers[REST APIs, proxies and kafka brokers] section.
====

== Search Intents
When an {vno-initials} wants to search intents it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

The {vno-initials} is able to search intents of the types that are configured in the allow list of the {app-short-name}.

=== Using the {app-short-name} WebUI

To search {ont-initials}s using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All created {ont-initials}s are listed in this section. For default, any filter is applied:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the filter button displayed on left of the screen.
+
image::gridFilter.png[align="center"]

. The filter options are shown:
+
image::vno_portal/ONTsSection_search.png[align="center"]

. Enter all filters. Click the *Apply filter* button.
+
image::vno_portal/ONTsSection_applyFilter.png[align="center"]

=== Using the REST Proxy
To search intents using the {app-short-name} IBN proxy a POST request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/operations/ibn:search-intents

[IMPORTANT]
Predicate "MATCHES" does not work except the target field is included in the query, and
it contains the full target of the intent to search. This is due to an Altiplano's limitation
of supporting wildcards in the middle of the target because WNP adds the identifier of the
{vno-initials} at the end.

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example - Example 1:: If an {vno-initials} wants to search all the intents of type ont that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/operations/ibn:search-intents
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:search-intents": {
        "search-from": "ES",
        "filter": {
            "intent-type-list": {
                "intent-type": "ont"
            },
            "predicate": "CONTAINS"
        }
    }
}
----

For example - Example 2:: If an {vno-initials} wants to search all the intents that contains the type l2-user that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/operations/ibn:search-intents
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:search-intents": {
        "search-from": "ES",
        "page-size": 10,
        "filter": {
            "predicate": "CONTAINS",
            "target": [],
            "intent-type-list": [
                {
                  "intent-type": "l2-user"
                }
            ],
            "argument": []
        }
    }
}
----

For example - Example 3:: if an {vno-initials} wants to search all the intents that contains the type ont and the target "L1.P1.ONT1" that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/operations/ibn:search-intents
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:search-intents": {
        "search-from": "ES",
        "page-size": 10,
        "filter": {
            "predicate": "CONTAINS",
            "target": ["L1.P1.ONT1"],
            "intent-type-list": [
                {
                    "intent-type": "ont"
                }
            ],
            "argument": []
        }
    }
}
----

[NOTE]
====
The access token of the {vno-initials} user must be sent in the request as a Bearer Authorization HTTP Header.
To retrieve a token, follow the steps in the xref:How_to_manage_WNP_access.adoc#_rest_apis_proxies_and_kafka_brokers[REST APIs, proxies and kafka brokers] section.
====

== Edit Intents

The {vno-initials} can edit {ont-initials} and service intents using the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy.

=== Using the {app-short-name} WebUI

To edit an {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the *Edit* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_editButton.png[align="center"]

. A popup with all data to modify is opened:
+
image::vno_portal/ONTsSection_editPopup.png[align="center"]

. Edit the desired values:
+
[NOTE]
====
The information to fill is divided in two tabs: *BASIC OPTIONS* and *ADVANCED OPTIONS*.
In this example only the BASIC OPTIONS is shown
====
+
The *version* and *target* fields can not be modified, and these values are shown in the popup title between parenthesis.

- *Required network state:* It is the network's state. Can be selected between: Active, Suspended or Not present.
- *Fiber Name*: It is the PON port.
- *PON Type*: It is the PON port type. Example: gpon.
- *ONT Type*: It is the ONT model.
- *Expected Serial Number*: It is the ONT serial number.
- *ONT Service Profile*: It is the service profile for the ONT.
- *UNI Service Configuration*: An UNI service profile must be added.

. Click the *SAVE* button.

=== Using the REST Proxy
To edit {ont-initials} intents using the {app-short-name} IBN proxy, a PATCH request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=<TARGET>,<INTENT-TYPE>?altiplano-triggerSyncUponSuccess=true

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example - Example 1:: If an {vno-initials} wants to edit the fiber name of an {ont-initials}, a PATCH request must be sent to the URL:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=L1.P1.ONT1,ont?altiplano-triggerSyncUponSuccess=true
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:intent": {
        "intent-specific-data": {
            "ont:ont": {
                "fiber-name": "DemoFX.LT1.PON2"
            }
        }
    }
}
----

For example - Example 2:: If an {vno-initials} wants to edit the onu service profile of an {ont-initials}, a PATCH request must be sent to the URL:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=L1.P1.ONT1,ont?altiplano-triggerSyncUponSuccess=true
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:intent": {
        "intent-specific-data": {
            "ont:ont": {
                "onu-service-profile": "default"
            }
        }
    }
}
----

== Delete an Intent
When an {vno-initials} wants to delete an intent it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

The {vno-initials} is able to delete intents of the types that are configured in the allow list of the {app-short-name}.

=== Using the {app-short-name} WebUI

To delete an {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the *Delete* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_deleteButton.png[align="center"]

=== Using the REST Proxy

To delete an intent using the {app-short-name} IBN proxy a DELETE request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/operations/ibn:delete-intent-from-network-and-controller

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example:: If an {vno-initials} wants to delete an intent of type ont that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/operations/ibn:delete-intent-from-network-and-controller
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:delete-intent-from-network-and-controller": {
        "target":"location1",
        "intent-type":"ont"
    }
}
----

[NOTE]
====
The access token of the {vno-initials} user must be sent in the request as a Bearer Authorization HTTP Header.
To retrieve a token, follow the steps in the xref:How_to_manage_WNP_access.adoc#_rest_apis_proxies_and_kafka_brokers[REST APIs, proxies and kafka brokers] section.
====

== Launch actions over Intents

When an {vno-initials} wants to launch actions over an intent it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

=== Using the {app-short-name} WebUI

To launch actions over an {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the *Launch actions* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_launchActionsButton.png[align="center"]

. A popup with all allowed actions is opened:
+
image::ONTsSection_launchActionsPopup.png[align="center"]

. Click over the desired action to launch.

. A confirmation popup is opened:
+
image::vno_portal/ONTsSection_launchActionConfirmation.png[align="center"]

. Click the *LAUNCH* button.

=== Using the REST Proxy

To launch an action over an intent using the {app-short-name} IBN proxy a POST request must be sent to the URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=<TARGET>,<INTENT-TYPE>?/intent-specific-data/ont-action:<ACTION>

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example - Example 1:: If an {vno-initials} wants to launch the reset-ont action over an intent of type ont and target location1 that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=location1,ont?/intent-specific-data/ont-action:reset-ont

For example - Example 2:: If an {vno-initials} wants to launch the deactivate-ont action over an intent of type ont and target location1 that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=location1,ont?/intent-specific-data/ont-action:deactivate-ont

== Suspend/Activate Intents
When an {vno-initials} wants to suspend or activate an intent it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

The {vno-initials} is able to suspend/activate intents of the types that are configured in the allow list of the {app-short-name}.

=== Using the {app-short-name} WebUI

To suspend or activate an {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

==== To suspend an {ont-initials}
. If the ONT is activated, the *Suspend* icon is shown. Click the *Suspend* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_suspendButton.png[align="center"]

. A confirmation popup is opened.
+
image::vno_portal/ONTsSection_confirmSuspend.png[align="left"]

. Click the *SUSPEND* button.

==== To activate an {ont-initials}
. If the ONT is suspended, the *Activate* icon is shown. Click the *Activate* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_activateButton.png[align="center"]

=== Using the REST Proxy

To suspend or activate an intent using the {app-short-name} IBN proxy a PATCH request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=<TARGET>,<INTENT-TYPE>?altiplano-triggerSyncUponSuccess=true

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example:: If an {vno-initials} wants to suspend an intent of type ont and target location1 that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=location1,ont?altiplano-triggerSyncUponSuccess=true
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:intent:": {
        "required-network-state": "suspend"
    }
}
----

For example:: If an {vno-initials} wants to activate an intent of type ont and target location1 that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=location1,ont?altiplano-triggerSyncUponSuccess=true
+
The following request body must be sent:
+
[source, json]
----
{
    "ibn:intent:": {
        "required-network-state": "active"
    }
}
----

[NOTE]
====
The access token of the {vno-initials} user must be sent in the request as a Bearer Authorization HTTP Header.
To retrieve a token, follow the steps in the xref:How_to_manage_WNP_access.adoc#_rest_apis_proxies_and_kafka_brokers[REST APIs, proxies and kafka brokers] section.
====

== Synchronize Intents
When an {vno-initials} wants to synchronize an intent it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

The {vno-initials} is able to sync intents of the types that are configured in the allow list of the {app-short-name}.

=== Using the {app-short-name} WebUI

To synchronize an {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the *Synchronize* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_syncButton.png[align="center"]

=== Using the REST Proxy

To synchronize an intent using the {app-short-name} IBN proxy a POST request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=<TARGET>,<INTENT-TYPE>/synchronize

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example:: If an {vno-initials} wants to synchronize an intent of type ont and target location1 that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=location1,ont/synchronize

[NOTE]
====
The access token of the {vno-initials} user must be sent in the request as a Bearer Authorization HTTP Header.
To retrieve a token, follow the steps in the xref:How_to_manage_WNP_access.adoc#_rest_apis_proxies_and_kafka_brokers[REST APIs, proxies and kafka brokers] section.
====

== Audit Intents
When an {vno-initials} wants to audit an intent it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

The {vno-initials} is able to audit intents of the types that are configured in the allow list of the {app-short-name}.

=== Using the {app-short-name} WebUI

To audit an {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the *Audit* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_auditButton.png[align="center"]

=== Using the REST Proxy

To audit an intent using the {app-short-name} IBN proxy a POST request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=<TARGET>,<INTENT-TYPE>/audit

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example:: If an {vno-initials} wants to audit an intent of type ont and target location1 that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/restconf/data/ibn:ibn/intent=location1,ont/audit

[NOTE]
====
The access token of the {vno-initials} user must be sent in the request as a Bearer Authorization HTTP Header.
To retrieve a token, follow the steps in the xref:How_to_manage_WNP_access.adoc#_rest_apis_proxies_and_kafka_brokers[REST APIs, proxies and kafka brokers] section.
====

== Start live monitoring
When an {vno-initials} wants to start a live collection it must use the {app-short-name} WebUI or the {app-short-name} IBN REST Proxy directly.

=== Using the {app-short-name} WebUI

To start a live collection an {ont-initials} using the WebUI, execute the following steps:

. Click the "{ont-initials}s" option on the menu bar displayed on top of the screen.
+
image::vno_portal/ONTs_menu.png[align="center"]

. All {ont-initials}s will be listed:
+
image::vno_portal/ONTsSection.png[align="center"]

. Click the *Start live monitoring* icon in "{ont-initials}" identifier row.
+
image::vno_portal/ONTsSection_startLiveMonitoringButton.png[align="center"]

=== Using the REST Proxy

To start a live collection using the {app-short-name} IBN proxy a POST request must be sent the following URL:
https://{altiplano-host}/{wnp-ibn-context}/rest/ibn/livecollection/<INTENT-TYPE>/<TARGET>

[NOTE]
====
The url is the same as the offered by Altiplano IBN but the difference is that instead of pointing to
nokia-altiplano-ac context the URL points to {wnp-ibn-context} proxy context.
====

For example:: If an {vno-initials} wants to start a live collection of type ont and target L1.P1.ONT1 that belongs to it:
https://{ip-host-example}/{wnp-ibn-context}/rest/ibn/livecollection/ont/L1.P1.ONT1

[NOTE]
====
The access token of the {vno-initials} user must be sent in the request as a Bearer Authorization HTTP Header.
To retrieve a token, follow the steps in the xref:How_to_manage_WNP_access.adoc#_rest_apis_proxies_and_kafka_brokers[REST APIs, proxies and kafka brokers] section.
====


include::ROOT:go-back-component.adoc[Back]